<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />

    <title>Spheroid-Trap Designer</title>
    
    <style>
      :root {
        font-family: Inter, system-ui, Avenir, Helvetica, Arial, sans-serif;
        line-height: 1.5;
        font-weight: 400;

        --joy-palette-common-white: #fff;
        --joy-palette-primary-500: #3070B3;

        font-synthesis: none;
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      header, footer {
        margin: 0;
        padding: 1rem 2rem;
        /* color: white; */
      }

      header > * {
        max-width: 1280px;
        margin: 0 auto;
        text-align: center;
      }

      footer > * {
        max-width: 1280px;
        margin: 0 auto;
        text-align: center;
      }

      body {
        line-height: 1.5;
        margin: 0;
        padding: 0;
        text-align: center;
        background-color: #F0F4F8;
      }

      .result { 
        margin-top: 20px;
        padding: 10px;
        font-size: 16px;
        /* font-weight: bold; */
        color: #3070B3; /* Adjust color as needed */
        /* background-color: #e0f2ff; /* Light blue background */
        /* border: 1px solid #016fb6; */
        /* border-radius: 5px;  */
        /* display: inline-block; Keeps box size dynamic */
      }

      #stlViewer {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 90%;
        max-width: 800px;
        height: 600px;
        margin: 20px auto;
        background-color: transparent;
    }

      /* Style the toggle switch NEW */
      .toggle-container {
            display: flex;
            border: 1px solid #ccc;
            border-radius: 6px;
            overflow: hidden;
            width: 200px;
            margin: 10px auto;
        }

        /* Hide default radio buttons */
        .toggle-container input {
            display: none;
        }

        /* Toggle Labels */
        .toggle-option {
            flex: 1;
            text-align: center;
            padding: 6px;
            font-size: 15px;
            /* font-weight: bold; */
            cursor: pointer;
            background-color: white;
            color: #333;
            transition: background 0.3s, color 0.3s;
            border-right: 1px solid #ccc;
        }

        /* Remove border for last element */
        .toggle-option:last-child {
            border-right: none;
        }

        /* Selected state */
        .toggle-container input:checked + .toggle-option {
            background-color: #016fb6;
            color: white;
        }

        /* Input fields */
        .input-container {
            margin: 10px 0;
        }

        .form-control {
            text-align: right; /* Align text to the right */
        }

        .input-group-text {
            background-color: white !important; /* Makes the box white TODO maybe change this back*/
            color: black; /* Ensures text is readable */
            border: 1px solid #ccc; /* Keeps border consistent with input field */
            padding-left: 2px; /* Move µm closer */
        }
        .input-group .form-control {
            border-right: none !important; /* Remove right border of input field */
            padding-right: 2px; 
        }

      /* Style for the submit button */
      #submitButton {
        background-color: #28a745; /* Green background */
        color: white; /* White text */
        border: none; /* Remove border */
        border-radius: 5px; /* Rounded corners */
        padding: 7px 17px; /* Padding for a larger button */
        font-size: 15px; /* Adjust font size */
        cursor: pointer; /* Pointer cursor on hover */
      }

      /* Hover effect for the submit button */
      #submitButton:hover {
        background-color: #218838; /* Darker green on hover */
      }

      /* Style download buttons */
      .button {
        display: inline-block;
        margin: 10px;
        padding: 7px 17px;
        text-decoration: none;
        color: white;
        /* background-color: #016fb6; */
        background-color: #28a745;
        border-radius: 5px;
        font-size: 15px;
        cursor: pointer;
      }

      .button:hover {
        background-color: #218838;
        color: white; /* White text */
      }
    </style>

  </head>

  <body>
    <header style="background-color: var(--joy-palette-primary-500); padding: 10px; display: flex; justify-content: center; align-items: center; height: 100px;">
      <div class="MuiBox-root css-0" style="display: flex; align-items: center; gap: 15px;">
        <svg id="logo" height="6em" viewBox="0 0 610 300" style="vertical-align: middle;"><g transform="matrix(1,0,0,-1,0,350)"><g><g><g transform="translate(228.5005,208.8693)"><path d="m 0,0 c -3.072,0 -5.562,2.49 -5.562,5.562 v 46.284 c 0,3.072 2.49,5.562 5.562,5.562 3.072,0 5.562,-2.49 5.562,-5.562 V 5.562 C 5.562,2.49 3.072,0 0,0" style="fill: var(--joy-palette-common-white); stroke: none;"></path></g><g transform="translate(185.1402,134.8453)"><path d="m 0,0 h -36.731 c -7.667,0 -13.905,6.238 -13.905,13.905 v 29.446 c 0,1.518 -1.235,2.765 -2.754,2.781 l -15.13,0.153 h -46.228 c -3.072,0 -5.562,2.49 -5.562,5.562 0,3.072 2.49,5.562 5.562,5.562 h 46.284 l 15.187,-0.154 c 7.59,-0.077 13.765,-6.314 13.765,-13.904 V 13.905 c 0,-1.534 1.247,-2.781 2.781,-2.781 H 0 c 3.072,0 5.562,-2.49 5.562,-5.562 C 5.562,2.49 3.072,0 0,0" style="fill: var(--joy-palette-common-white); stroke: none;"></path></g><g transform="translate(70.9973,134.8453)"><path d="m 0,0 c -3.072,0 -5.562,2.49 -5.562,5.562 v 19.506 c 0,4.983 4.054,9.038 9.038,9.038 h 41.598 c 3.072,0 5.562,-2.49 5.562,-5.562 0,-3.072 -2.49,-5.562 -5.562,-5.562 H 5.562 V 5.562 C 5.562,2.49 3.072,0 0,0" style="fill: var(--joy-palette-common-white); stroke: none;"></path></g><g transform="translate(408.3501,254.9739)"><path d="m 0,0 c -1.534,0 -2.781,-1.248 -2.781,-2.781 v -29.264 c 0,-1.534 1.247,-2.781 2.781,-2.781 h 47.594 c 1.534,0 2.781,1.247 2.781,2.781 V -2.781 C 50.375,-1.248 49.128,0 47.594,0 Z M 47.594,-45.95 H 0 c -7.667,0 -13.905,6.238 -13.905,13.905 v 29.264 c 0,7.667 6.238,13.905 13.905,13.905 h 47.594 c 7.668,0 13.905,-6.238 13.905,-13.905 v -29.264 c 0,-7.667 -6.237,-13.905 -13.905,-13.905" id="path32" style="fill: var(--joy-palette-common-white); stroke: none;"></path></g><g transform="translate(381.3805,208.868)"><path d="m 0,0 c -0.844,0 -1.7,0.193 -2.505,0.599 l -34.911,17.643 -0.595,0.565 c -2.183,2.078 -2.871,5.229 -1.753,8.027 1.119,2.799 3.79,4.607 6.803,4.607 h 20.451 c 1.534,0 2.781,1.248 2.781,2.781 v 9.103 c 0,1.533 -1.247,2.781 -2.781,2.781 h -36.47 c -1.534,0 -2.782,-1.248 -2.782,-2.782 L -51.763,14.061 C -51.763,6.394 -58,0.156 -65.667,0.156 h -54.705 c -7.668,0 -13.905,6.238 -13.905,13.905 v 29.264 c 0,7.667 6.237,13.905 13.905,13.905 h 46.899 c 3.072,0 5.562,-2.49 5.562,-5.562 0,-3.072 -2.49,-5.562 -5.562,-5.562 h -46.899 c -1.534,0 -2.781,-1.248 -2.781,-2.781 V 14.061 c 0,-1.534 1.247,-2.781 2.781,-2.781 h 54.705 c 1.533,0 2.781,1.247 2.781,2.781 v 29.264 c 0.002,7.668 6.239,13.905 13.906,13.905 h 36.47 c 7.667,0 13.905,-6.238 13.905,-13.905 v -9.103 c 0,-7.667 -6.238,-13.904 -13.905,-13.904 h -4.35 L 2.513,10.527 C 5.254,9.142 6.354,5.796 4.968,3.055 3.989,1.118 2.031,0 0,0" style="fill: var(--joy-palette-common-white); stroke: none;"></path></g><g transform="translate(352.7401,134.8453)"><path d="m 0,0 h -46.899 c -3.072,0 -5.562,2.49 -5.562,5.562 0,3.072 2.49,5.562 5.562,5.562 H 0 c 1.534,0 2.781,1.247 2.781,2.781 v 29.256 c 0,1.538 -1.251,2.789 -2.79,2.789 h -46.89 c -3.072,0 -5.562,2.49 -5.562,5.562 0,3.072 2.49,5.562 5.562,5.562 h 46.89 c 7.672,0 13.914,-6.241 13.914,-13.913 V 13.905 C 13.905,6.238 7.667,0 0,0" style="fill: var(--joy-palette-common-white); stroke: none;"></path></g><g transform="translate(250.9165,134.8453)"><path d="M 0,0 H -42.033 C -49.7,0 -55.938,6.238 -55.938,13.905 v 37.72 c 0,3.072 2.49,5.562 5.562,5.562 3.072,0 5.562,-2.49 5.562,-5.562 v -37.72 c 0,-1.534 1.248,-2.781 2.781,-2.781 H 0 c 1.534,0 2.781,1.247 2.781,2.781 v 37.72 c 0,3.072 2.49,5.562 5.562,5.562 3.071,0 5.562,-2.49 5.562,-5.562 V 13.905 C 13.905,6.238 7.667,0 0,0" style="fill: var(--joy-palette-common-white); stroke: none;"></path></g><g transform="translate(518.9844,168.951)"><path d="m 0,0 h -33.016 c -1.527,0 -2.77,1.037 -2.77,2.312 v 7.223 c 0,1.281 1.248,2.323 2.781,2.323 H 8.333 c 3.071,0 5.562,2.49 5.562,5.562 0,3.072 -2.491,5.562 -5.562,5.562 h -41.338 c -7.667,0 -13.904,-6.032 -13.904,-13.447 V 2.312 c 0,-7.408 6.232,-13.436 13.893,-13.436 H 0 c 1.528,0 2.771,-1.037 2.771,-2.312 v -7.223 c 0,-1.281 -1.248,-2.323 -2.781,-2.323 h -101.586 c -1.534,0 -2.781,1.248 -2.781,2.781 V 9.064 c 0,1.533 1.247,2.781 2.781,2.781 h 43.423 c 3.071,0 5.562,2.49 5.562,5.562 0,3.072 -2.491,5.562 -5.562,5.562 h -43.423 c -7.667,0 -13.905,-6.238 -13.905,-13.905 v -29.265 c 0,-7.667 6.238,-13.905 13.905,-13.905 H -0.01 c 7.667,0 13.905,6.032 13.905,13.447 v 7.223 C 13.895,-6.028 7.661,0 0,0" style="fill: var(--joy-palette-common-white); stroke: none;"></path></g><g transform="translate(384.9837,134.8453)"><path d="m 0,0 c -3.072,0 -5.562,2.49 -5.562,5.562 v 46.285 c 0,3.072 2.49,5.562 5.562,5.562 3.072,0 5.562,-2.49 5.562,-5.562 V 5.562 C 5.562,2.49 3.072,0 0,0" style="fill: var(--joy-palette-common-white); stroke: none;"></path></g><g transform="translate(283.2219,134.8453)"><path d="m 0,0 c -3.072,0 -5.562,2.49 -5.562,5.562 v 46.285 c 0,3.072 2.49,5.562 5.562,5.562 3.072,0 5.562,-2.49 5.562,-5.562 V 5.562 C 5.562,2.49 3.072,0 0,0" style="fill: var(--joy-palette-common-white); stroke: none;"></path></g><g transform="translate(565.3289,207.5402)"><path d="m 0,0 c -0.834,0 -1.673,0.271 -2.376,0.83 l -18.258,14.509 c -3.001,2.385 -6.765,3.698 -10.597,3.698 h -46.197 c -2.111,0 -3.824,1.712 -3.824,3.824 0,2.112 1.713,3.824 3.824,3.824 h 46.197 c 5.553,0 11.007,-1.903 15.355,-5.359 L 2.382,6.818 C 4.035,5.503 4.31,3.098 2.996,1.445 2.241,0.495 1.126,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(576.1119,207.5402)"><path d="m 0,0 c -3.569,0 -6.472,-2.903 -6.472,-6.471 0,-3.569 2.903,-6.472 6.472,-6.472 3.568,0 6.471,2.903 6.471,6.472 C 6.471,-2.903 3.568,0 0,0 m 0,-20.59 c -7.785,0 -14.119,6.334 -14.119,14.119 0,7.785 6.334,14.119 14.119,14.119 7.785,0 14.119,-6.334 14.119,-14.119 C 14.119,-14.256 7.785,-20.59 0,-20.59" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(118.4726,226.5773)"><path d="m 0,0 h -39.244 c -5.554,0 -11.008,1.903 -15.355,5.358 l -18.258,14.509 c -1.653,1.314 -1.928,3.719 -0.615,5.373 1.314,1.653 3.72,1.928 5.373,0.614 l 18.258,-14.509 c 3,-2.384 6.764,-3.697 10.597,-3.697 L 0,7.648 C 2.112,7.648 3.824,5.936 3.824,3.824 3.824,1.712 2.112,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(37.2145,266.2045)"><path d="m 0,0 c -3.569,0 -6.472,-2.903 -6.472,-6.471 0,-3.569 2.903,-6.472 6.472,-6.472 3.568,0 6.471,2.903 6.471,6.472 C 6.471,-2.903 3.568,0 0,0 m 0,-20.59 c -7.785,0 -14.119,6.334 -14.119,14.119 0,7.785 6.334,14.119 14.119,14.119 7.785,0 14.119,-6.334 14.119,-14.119 C 14.119,-14.256 7.785,-20.59 0,-20.59" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(421.5666,285.9801)"><path d="m 0,0 h -60.101 c -2.111,0 -3.823,1.712 -3.823,3.824 0,2.112 1.712,3.824 3.823,3.824 H 0 c 3.833,0 7.597,1.313 10.598,3.698 l 18.257,14.508 c 1.655,1.315 4.059,1.038 5.372,-0.614 1.314,-1.654 1.039,-4.059 -0.614,-5.373 L 15.356,5.358 C 11.007,1.903 5.554,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(463.5809,325.6075)"><path d="m 0,0 c -3.568,0 -6.471,-2.903 -6.471,-6.472 0,-3.568 2.903,-6.471 6.471,-6.471 3.569,0 6.472,2.903 6.472,6.471 C 6.472,-2.903 3.569,0 0,0 m 0,-20.591 c -7.785,0 -14.119,6.334 -14.119,14.119 0,7.786 6.334,14.12 14.119,14.12 7.785,0 14.119,-6.334 14.119,-14.12 0,-7.785 -6.334,-14.119 -14.119,-14.119" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(128.1492,88.0148)"><path d="m 0,0 c -1.126,0 -2.241,0.495 -2.996,1.445 -1.314,1.653 -1.039,4.058 0.615,5.373 l 18.257,14.509 c 4.349,3.455 9.802,5.357 15.356,5.357 h 126.843 c 2.112,0 3.824,-1.712 3.824,-3.823 0,-2.112 -1.712,-3.824 -3.824,-3.824 H 31.232 c -3.833,0 -7.597,-1.313 -10.598,-3.698 L 2.377,0.83 C 1.673,0.271 0.834,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(120.4365,88.9772)"><path d="m 0,0 c -3.568,0 -6.471,-2.903 -6.471,-6.471 0,-3.569 2.903,-6.472 6.471,-6.472 3.568,0 6.471,2.903 6.471,6.472 C 6.471,-2.903 3.568,0 0,0 m 0,-20.59 c -7.785,0 -14.119,6.334 -14.119,14.119 0,7.785 6.334,14.119 14.119,14.119 7.785,0 14.119,-6.334 14.119,-14.119 C 14.119,-14.256 7.785,-20.59 0,-20.59" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(203.7303,209.0238)"><path d="M 0,0 C -3.072,0 -5.562,2.49 -5.562,5.562 V 43.13 L -24.726,26.257 c -3.328,-2.929 -8.227,-3.01 -11.649,-0.19 L -57.707,43.646 V 5.562 C -57.707,2.49 -60.197,0 -63.269,0 -66.34,0 -68.83,2.49 -68.83,5.562 v 42.621 c 0,3.514 1.974,6.627 5.151,8.126 3.177,1.499 6.835,1.041 9.545,-1.194 l 23.426,-19.304 21.35,18.797 c 2.684,2.364 6.376,2.917 9.636,1.444 3.259,-1.473 5.284,-4.61 5.284,-8.186 V 5.562 C 5.562,2.49 3.072,0 0,0" style="fill: var(--joy-palette-common-white); stroke: none;"></path></g><g transform="translate(256.4747,286.1511)"><path d="m 0,0 c -1.462,0 -2.648,1.186 -2.648,2.648 v 20.795 c 0,1.462 1.186,2.648 2.648,2.648 1.462,0 2.648,-1.186 2.648,-2.648 V 2.648 C 2.648,1.186 1.462,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(304.6848,286.1511)"><path d="m 0,0 c -1.462,0 -2.648,1.186 -2.648,2.648 v 20.795 c 0,1.462 1.186,2.648 2.648,2.648 1.462,0 2.648,-1.186 2.648,-2.648 V 2.648 C 2.648,1.186 1.462,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(333.564,286.1511)"><path d="m 0,0 c -1.462,0 -2.648,1.186 -2.648,2.648 v 20.795 c 0,1.462 1.186,2.648 2.648,2.648 1.462,0 2.648,-1.186 2.648,-2.648 V 2.648 C 2.648,1.186 1.462,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(333.564,296.5483)"><path d="m 0,0 h -27.925 c -1.462,0 -2.648,1.186 -2.648,2.648 0,1.462 1.186,2.648 2.648,2.648 H 0 C 1.462,5.296 2.648,4.11 2.648,2.648 2.648,1.186 1.462,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(293.6353,286.2261)"><path d="m 0,0 h -21.071 c -3.527,0 -6.396,2.869 -6.396,6.396 v 13.148 c 0,3.527 2.869,6.396 6.396,6.396 H 0 c 1.462,0 2.648,-1.185 2.648,-2.648 C 2.648,21.83 1.462,20.644 0,20.644 h -21.071 c -0.607,0 -1.1,-0.493 -1.1,-1.1 V 6.396 c 0,-0.607 0.493,-1.1 1.1,-1.1 L 0,5.296 C 1.462,5.296 2.648,4.11 2.648,2.648 2.648,1.186 1.462,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(200.1843,286.2009)"><path d="m 0,0 h -18.884 c -3.527,0 -6.396,2.869 -6.396,6.396 v 16.947 c 0,1.463 1.185,2.648 2.648,2.648 1.462,0 2.648,-1.185 2.648,-2.648 V 6.396 c 0,-0.607 0.493,-1.1 1.1,-1.1 L 0,5.296 c 0.606,0 1.1,0.493 1.1,1.1 v 16.947 c 0,1.463 1.186,2.648 2.648,2.648 1.463,0 2.648,-1.185 2.648,-2.648 V 6.396 C 6.396,2.869 3.527,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(166.4274,286.0383)"><path d="m 0,0 c -1.462,0 -2.648,1.186 -2.648,2.648 v 16.907 l -8.566,-7.542 c -1.559,-1.373 -3.856,-1.411 -5.46,-0.089 L -26.232,19.8 V 2.648 C -26.232,1.186 -27.417,0 -28.88,0 c -1.462,0 -2.648,1.186 -2.648,2.648 v 19.455 c 0,1.646 0.925,3.105 2.414,3.808 1.489,0.701 3.203,0.488 4.473,-0.559 l 10.622,-8.753 9.675,8.519 c 1.258,1.107 2.989,1.366 4.516,0.677 1.527,-0.691 2.476,-2.161 2.476,-3.837 V 2.648 C 2.648,1.186 1.462,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(242.7682,285.9801)"><path d="M 0,0 C -0.86,0 -1.715,0.265 -2.446,0.788 L -2.631,0.933 -24.667,19.849 V 3.05 c 0,-1.462 -1.186,-2.648 -2.648,-2.648 -1.463,0 -2.648,1.186 -2.648,2.648 v 19.17 c 0,1.585 0.875,3.019 2.284,3.744 1.408,0.724 3.085,0.602 4.374,-0.319 L -23.12,25.5 -1.083,6.584 v 17.111 c 0,1.462 1.185,2.647 2.647,2.647 1.463,0 2.648,-1.185 2.648,-2.647 V 4.212 C 4.212,2.628 3.337,1.194 1.928,0.469 1.318,0.155 0.657,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(446.8113,88.4777)"><path d="m 0,0 h -16.71 c -3.552,0 -6.443,2.89 -6.443,6.443 v 17.153 c 0,1.462 1.186,2.648 2.648,2.648 1.462,0 2.648,-1.186 2.648,-2.648 V 6.443 c 0,-0.632 0.515,-1.147 1.147,-1.147 L 0,5.296 C 1.462,5.296 2.648,4.11 2.648,2.648 2.648,1.186 1.462,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><path d="m 387.133,93.796 h 23.946 v 15.607 H 387.133 Z M 411.147,88.5 h -24.083 c -2.882,0 -5.227,2.345 -5.227,5.227 v 15.745 c 0,2.883 2.345,5.227 5.227,5.227 h 24.083 c 2.883,0 5.228,-2.344 5.228,-5.227 V 93.727 c 0,-2.882 -2.345,-5.227 -5.228,-5.227" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path><path d="m 346.329,93.796 h 23.946 v 15.607 H 346.329 Z M 370.344,88.5 h -24.083 c -2.883,0 -5.228,2.345 -5.228,5.227 v 15.745 c 0,2.883 2.345,5.227 5.228,5.227 h 24.083 c 2.883,0 5.227,-2.344 5.227,-5.227 V 93.727 c 0,-2.882 -2.344,-5.227 -5.227,-5.227" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path><g transform="translate(497.9079,88.4237)"><path d="m 0,0 c -1.462,0 -2.648,1.186 -2.648,2.648 v 21.056 c 0,1.462 1.186,2.648 2.648,2.648 1.462,0 2.648,-1.186 2.648,-2.648 V 2.648 C 2.648,1.186 1.462,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(519.7025,88.4237)"><path d="m 0,0 c -1.462,0 -2.648,1.186 -2.648,2.648 v 21.056 c 0,1.462 1.186,2.648 2.648,2.648 1.462,0 2.648,-1.186 2.648,-2.648 V 2.648 C 2.648,1.186 1.462,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(530.231,109.4797)"><path d="m 0,0 h -21.056 c -1.463,0 -2.648,1.186 -2.648,2.648 0,1.462 1.185,2.648 2.648,2.648 H 0 C 1.462,5.296 2.648,4.11 2.648,2.648 2.648,1.186 1.462,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(323.9362,88.4237)"><path d="m 0,0 c -1.462,0 -2.648,1.186 -2.648,2.648 v 21.056 c 0,1.462 1.186,2.648 2.648,2.648 1.462,0 2.648,-1.186 2.648,-2.648 V 2.648 C 2.648,1.186 1.462,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(334.464,109.4797)"><path d="m 0,0 h -21.056 c -1.462,0 -2.648,1.186 -2.648,2.648 0,1.462 1.186,2.648 2.648,2.648 H 0 C 1.462,5.296 2.648,4.11 2.648,2.648 2.648,1.186 1.462,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(458.2416,88.4237)"><path d="m 0,0 c -1.462,0 -2.648,1.186 -2.648,2.648 v 21.056 c 0,1.462 1.186,2.648 2.648,2.648 1.462,0 2.648,-1.186 2.648,-2.648 V 2.648 C 2.648,1.186 1.462,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(472.9735,98.9518)"><path d="m 0,0 h -14.732 c -1.462,0 -2.648,1.186 -2.648,2.648 0,1.462 1.186,2.648 2.648,2.648 H 0 c 2.57,0 4.936,1.398 6.177,3.648 l 3.037,5.51 c 0.705,1.28 2.315,1.747 3.597,1.041 1.281,-0.706 1.747,-2.317 1.041,-3.598 L 10.815,6.388 C 8.644,2.448 4.499,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g><g transform="translate(485.5687,88.4231)"><path d="m 0,0 c -0.934,0 -1.839,0.495 -2.321,1.37 l -3.038,5.51 c -1.24,2.251 -3.607,3.649 -6.177,3.649 h -14.731 c -1.463,0 -2.648,1.185 -2.648,2.648 0,1.462 1.185,2.648 2.648,2.648 h 14.731 c 4.5,0 8.644,-2.448 10.815,-6.389 L 2.316,3.927 C 3.022,2.646 2.556,1.036 1.276,0.33 0.87,0.106 0.432,0 0,0" style="fill: hsl(from var(--joy-palette-primary-500) h s calc(l * 2.3)); stroke: none;"></path></g></g></g></g></svg>
        <h1 class="MuiTypography-root MuiTypography-h1 css-1e2dbqh-JoyTypography-root" style="font-weight: bold; color: white; margin: 0;">
          Spheroid-Trap Designer
        </h1>
      </div>
    </header>
 
  <div style="padding-top: 20px;"></div>

  <p style="font-size: 16px; margin-top: 10px; text-align: center;">
    This tool generates a microfluidc chip or channel design based on an input spheroid diameter. 
    <a href="https://github.com/cda-tum/spheroid-trap-designer" target="_blank" style="color: #3070B3; text-decoration: none;">
      Learn more</a>.
  </p>

  <div class="container" style="max-width: 600px;">
    <div class="row">
      <div class="col-md-6">
        <label for="spheroid_diameter">Spheroid diameter:</label>
        <div class="input-group">
          <input type="number" id="spheroid_diameter" class="form-control">
          <span class="input-group-text">µm</span>
        </div>
      </div>
      <div class="col-md-6">
        <label for="nr_of_traps">No. of Traps:</label>
        <input type="number" id="nr_of_traps" class="form-control" value="1">
      </div>
    </div>
  </div>

  <div class="input-container">
    <!-- <label>Geometry:</label> -->
    <div class="toggle-container">
        <input type="radio" id="geometryToggle" name="geometry" value="geometryToggle" checked>
        <label for="geometryToggle" class="toggle-option">Chip</label>

        <input type="radio" id="chip" name="geometry" value="chip">
        <label for="chip" class="toggle-option">Channel</label>
    </div>
  </div>
  
  <br>
  <button id="submitButton" onclick="sendData()">Generate</button>
  <br>

  <div id="output">
    <div class="result" id="resultData"></div>
    <!-- Download Buttons -->
    <div id="downloadButtons" style="display: none;">
      <a id="downloadSVG" class="button" href="#" download="output2D.svg" style="display: inline-flex; align-items: center; padding: 7px 12px;">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-right: 4px;">
          <path d="M12 3v12"></path>  <!-- Arrow down -->
          <path d="M6 11l6 6 6-6"></path>  <!-- Arrow head -->
          <path d="M5 21h14"></path>  <!-- Horizontal line -->
        </svg>
        <span style="white-space: nowrap;">Download .svg (2D)</span>
      </a>
      <a id="downloadDXF" class="button" href="#" download="output2D.dxf" style="display: inline-flex; align-items: center; padding: 7px 12px;">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-right: 4px;">
          <path d="M12 3v12"></path>  <!-- Arrow down -->
          <path d="M6 11l6 6 6-6"></path>  <!-- Arrow head -->
          <path d="M5 21h14"></path>  <!-- Horizontal line -->
        </svg>
        <span style="white-space: nowrap;">Download .dxf (2D)</span>
      </a>
      <a id="downloadSTL" class="button" href="#" download="output3D.stl" style="display: inline-flex; align-items: center; padding: 7px 12px;">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-right: 4px;">
          <path d="M12 3v12"></path>  <!-- Arrow down -->
          <path d="M6 11l6 6 6-6"></path>  <!-- Arrow head -->
          <path d="M5 21h14"></path>  <!-- Horizontal line -->
        </svg>
        <span style="white-space: nowrap;">Download .stl (3D)</span>
      </a>
      
    </div>
    <div>
        <img id="resultSvg" alt="Result Image" style="display: none;">
    </div>  
    <div id="stlViewer" style="width: 600px; height: 400px; margin: auto; background-color: transparent;"></div>
    <br>
  </div>

  <!-- <footer style="background-color: var(--joy-palette-primary-500); color: white; text-align: center; padding: 10px;">
    <div class="MuiBox-root css-0"></div>
    <a href="https://www.cda.cit.tum.de/research/microfluidics/" style="color: white; text-decoration: none;">
      <Typography level="h4">
        Chair for Design Automation<br />Technical University of Munich
      </Typography>
    </a>
  </footer> -->
  
  <footer style="background-color: var(--joy-palette-primary-500); color: white; text-align: center; padding: 10px;">
    <div style="display: flex; justify-content: space-between; align-items: center; max-width: 1000px; margin: 0 auto;">
    <!-- <p style="font-size: 16px; font-weight: bold; margin-bottom: 8px;">
      Developed in collaboration between:
    </p> -->
      <div style="flex: 1; display: flex; justify-content: center; align-items: center;">
        <a href="https://www.cda.cit.tum.de/research/microfluidics/" target="_blank" style="color: white; text-decoration: none;">
          <!-- Chair for Design Automation<br> -->
          <!-- Technical University of Munich -->
          <svg version="1.1" id="Ebene_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1750 590" style="height: 50px; width: auto;">
          <style type="text/css">
            .st0{fill:#3070B3;}
            .st1{fill:#FFFFFF;}
          </style>
          <g>
            <rect x="808" class="st0" width="942" height="590"/>
            <rect class="st0" width="751" height="590"/>
          </g>
          <g>
            <polygon class="st1" points="1279,100 1279,420 1199,420 1199,100 909,100 909,170 979,170 979,490 1049,490 1049,170 1129,170 
              1129,490 1349,490 1349,170 1429,170 1429,490 1499,490 1499,170 1579,170 1579,490 1649,490 1649,100 	"/>
            <g>
              <g>
                <path class="st1" d="M130.6,110H101v-10h71.1v10h-29.6v79h-11.8V110z"/>
                <path class="st1" d="M222.1,168.5c-1.4,7.1-4.5,12.6-9.4,16.3c-4.8,3.7-10.9,5.6-18.2,5.6c-5.2,0-9.6-0.9-13.4-2.6
                  c-3.8-1.7-7-4-9.5-7c-2.6-3-4.5-6.6-5.8-10.7c-1.3-4.2-2-8.7-2.2-13.6c0-4.8,0.7-9.3,2.2-13.4c1.5-4.1,3.6-7.7,6.3-10.7
                  c2.7-3,5.9-5.3,9.6-7c3.7-1.7,7.7-2.5,12.1-2.5c5.7,0,10.5,1.2,14.3,3.6c3.8,2.4,6.8,5.4,9.1,9c2.3,3.7,3.9,7.6,4.7,12
                  c0.9,4.3,1.2,8.4,1.1,12.3h-48.2c-0.1,2.8,0.2,5.5,1,8c0.7,2.5,2,4.8,3.6,6.7c1.7,2,3.8,3.5,6.4,4.7c2.6,1.2,5.6,1.7,9.1,1.7
                  c4.4,0,8.1-1,11-3.1c2.9-2.1,4.8-5.2,5.7-9.5H222.1z M211.7,150.6c-0.2-2.5-0.7-4.9-1.7-7.1c-1-2.2-2.2-4.2-3.9-5.8
                  c-1.6-1.6-3.6-2.9-5.8-3.9c-2.2-1-4.7-1.4-7.2-1.4c-2.7,0-5.2,0.5-7.4,1.4c-2.2,1-4.1,2.3-5.7,3.9c-1.6,1.7-2.8,3.6-3.7,5.8
                  c-0.9,2.2-1.5,4.5-1.6,7H211.7z"/>
                <path class="st1" d="M278.3,145.2c-0.8-4.1-2.6-7.2-5.3-9.5c-2.7-2.2-6.2-3.4-10.7-3.4c-3.8,0-7,0.7-9.6,2.1
                  c-2.6,1.4-4.6,3.3-6.2,5.6c-1.5,2.3-2.6,5-3.3,8c-0.7,3-1,6.2-1,9.4c0,3,0.4,5.9,1.1,8.7c0.7,2.8,1.8,5.3,3.3,7.5
                  c1.5,2.2,3.4,4,5.8,5.3c2.4,1.3,5.3,2,8.7,2c5.1,0,9.2-1.4,12.2-4.2c3-2.8,4.8-6.6,5.5-11.5h10.8c-1.2,7.9-4.2,14-9,18.4
                  c-4.8,4.4-11.3,6.6-19.4,6.6c-4.9,0-9.2-0.8-13-2.4c-3.8-1.6-6.9-3.9-9.5-6.8c-2.5-2.9-4.4-6.4-5.7-10.4c-1.3-4-1.9-8.4-1.9-13.3
                  c0-4.8,0.6-9.3,1.9-13.5c1.2-4.2,3.1-7.8,5.7-11c2.5-3.1,5.7-5.6,9.5-7.3c3.8-1.8,8.2-2.7,13.4-2.7c3.7,0,7.1,0.4,10.3,1.3
                  c3.2,0.9,6,2.2,8.5,4c2.5,1.8,4.5,4.1,6,6.9c1.5,2.8,2.5,6.1,2.9,9.9H278.3z"/>
                <path class="st1" d="M302.1,100h10.6v34h0.2c0.8-1.9,2-3.6,3.6-5c1.5-1.4,3.2-2.6,5-3.4c1.8-0.9,3.8-1.5,5.8-1.9
                  c2-0.4,4-0.6,5.9-0.6c4.2,0,7.8,0.6,10.6,1.7c2.8,1.2,5.1,2.8,6.9,4.9c1.7,2.1,3,4.5,3.7,7.4c0.7,2.9,1.1,6,1.1,9.5v42.4h-10.6
                  v-43.6c0-4-1.2-7.1-3.5-9.5c-2.3-2.3-5.5-3.5-9.6-3.5c-3.2,0-6,0.5-8.4,1.5c-2.4,1-4.3,2.4-5.9,4.2c-1.6,1.8-2.8,4-3.6,6.4
                  c-0.8,2.5-1.2,5.1-1.2,8v36.4h-10.6V100z"/>
                <path class="st1" d="M371.9,124.5h10v10.2h0.2c2.2-4,5.1-6.9,8.7-8.8c3.5-1.9,7.6-2.9,12.3-2.9c4.2,0,7.8,0.6,10.6,1.7
                  c2.8,1.2,5.1,2.8,6.9,4.9c1.7,2.1,3,4.5,3.7,7.4c0.7,2.9,1.1,6,1.1,9.5v42.4h-10.6v-43.6c0-4-1.2-7.1-3.5-9.5
                  c-2.3-2.3-5.5-3.5-9.6-3.5c-3.2,0-6,0.5-8.4,1.5c-2.4,1-4.3,2.4-5.9,4.2c-1.6,1.8-2.8,4-3.6,6.4c-0.8,2.5-1.2,5.1-1.2,8v36.4
                  h-10.6V124.5z"/>
                <path class="st1" d="M453,113h-10.6v-13H453V113z M442.4,124.5H453v64.4h-10.6V124.5z"/>
                <path class="st1" d="M513.8,145.2c-0.8-4.1-2.6-7.2-5.3-9.5c-2.7-2.2-6.2-3.4-10.7-3.4c-3.8,0-7,0.7-9.6,2.1
                  c-2.6,1.4-4.6,3.3-6.2,5.6c-1.5,2.3-2.6,5-3.3,8c-0.7,3-1,6.2-1,9.4c0,3,0.4,5.9,1.1,8.7c0.7,2.8,1.8,5.3,3.3,7.5
                  c1.5,2.2,3.4,4,5.8,5.3c2.4,1.3,5.3,2,8.7,2c5.1,0,9.2-1.4,12.2-4.2c3-2.8,4.8-6.6,5.5-11.5h10.8c-1.2,7.9-4.2,14-9,18.4
                  c-4.8,4.4-11.3,6.6-19.4,6.6c-4.9,0-9.2-0.8-13-2.4c-3.8-1.6-6.9-3.9-9.5-6.8c-2.5-2.9-4.4-6.4-5.7-10.4c-1.3-4-1.9-8.4-1.9-13.3
                  c0-4.8,0.6-9.3,1.9-13.5c1.2-4.2,3.1-7.8,5.7-11c2.5-3.1,5.7-5.6,9.5-7.3c3.8-1.8,8.2-2.7,13.4-2.7c3.7,0,7.1,0.4,10.3,1.3
                  c3.2,0.9,6,2.2,8.5,4c2.5,1.8,4.5,4.1,6,6.9c1.5,2.8,2.5,6.1,2.9,9.9H513.8z"/>
                <path class="st1" d="M594.7,188.7c-1.9,1.2-4.4,1.7-7.6,1.7c-2.7,0-4.9-0.8-6.5-2.4c-1.6-1.6-2.4-4.1-2.4-7.6
                  c-2.9,3.5-6.3,6-10.2,7.6c-3.9,1.6-8,2.4-12.5,2.4c-2.9,0-5.7-0.3-8.3-1c-2.6-0.7-4.9-1.7-6.8-3.2c-1.9-1.5-3.4-3.3-4.5-5.6
                  c-1.1-2.3-1.7-5-1.7-8.3c0-3.7,0.6-6.6,1.9-9c1.2-2.3,2.9-4.2,4.9-5.6c2-1.4,4.4-2.5,7-3.3c2.6-0.8,5.3-1.4,8-1.9
                  c2.9-0.6,5.7-1,8.3-1.3c2.6-0.3,4.9-0.7,6.9-1.2c2-0.5,3.6-1.3,4.7-2.4c1.2-1,1.7-2.6,1.7-4.5c0-2.3-0.4-4.2-1.3-5.6
                  c-0.9-1.4-2-2.5-3.4-3.2c-1.4-0.7-2.9-1.2-4.6-1.5c-1.7-0.2-3.4-0.4-5-0.4c-4.5,0-8.2,0.9-11.2,2.6c-3,1.7-4.6,4.9-4.9,9.7h-10.6
                  c0.2-4,1-7.4,2.5-10.1c1.5-2.7,3.5-5,6-6.7c2.5-1.7,5.4-2.9,8.6-3.7c3.2-0.7,6.6-1.1,10.2-1.1c2.9,0,5.8,0.2,8.7,0.6
                  c2.9,0.4,5.5,1.3,7.8,2.6c2.3,1.3,4.2,3.1,5.6,5.4c1.4,2.3,2.1,5.4,2.1,9.1v33.1c0,2.5,0.1,4.3,0.4,5.5c0.3,1.2,1.3,1.7,2.9,1.7
                  c1,0,2.1-0.2,3.2-0.6V188.7z M577.5,155.7c-1,0.7-2.2,1.3-3.7,1.7c-1.5,0.4-3.1,0.8-4.7,1.1c-1.7,0.3-3.4,0.5-5.3,0.7
                  c-1.9,0.2-3.7,0.5-5.4,0.8c-1.7,0.3-3.4,0.7-5,1.2c-1.6,0.5-2.9,1.2-4.1,2.1c-1.2,0.9-2.1,2-2.8,3.3c-0.7,1.3-1.1,3-1.1,5
                  c0,1.7,0.4,3.2,1.1,4.4c0.7,1.2,1.6,2.2,2.7,2.9c1.1,0.7,2.4,1.3,3.9,1.6c1.5,0.3,3.1,0.5,4.7,0.5c3.5,0,6.5-0.5,9-1.4
                  c2.5-1,4.5-2.2,6.1-3.6c1.6-1.5,2.7-3,3.5-4.7c0.7-1.7,1.1-3.3,1.1-4.8V155.7z"/>
                <path class="st1" d="M605.8,100h10.6v88.9h-10.6V100z"/>
                <path class="st1" d="M179.5,307.1c0,11.3-3.1,19.8-9.2,25.6c-6.1,5.8-14.7,8.7-25.8,8.7c-5.7,0-10.9-0.7-15.4-2
                  c-4.5-1.3-8.3-3.4-11.5-6.2c-3.1-2.8-5.5-6.4-7.2-10.7c-1.7-4.3-2.5-9.4-2.5-15.3v-56.8h11.8v56.8c0,7.9,2.1,13.9,6.4,18.1
                  c4.3,4.2,10.4,6.2,18.2,6.2c7.6,0,13.3-2.1,17.3-6.2c3.9-4.2,5.9-10.2,5.9-18.1v-56.8h11.8V307.1z"/>
                <path class="st1" d="M195.4,274.8h10V285h0.3c2.2-4,5.1-6.9,8.7-8.8c3.5-1.9,7.6-2.9,12.3-2.9c4.2,0,7.8,0.6,10.6,1.7
                  c2.8,1.2,5.1,2.8,6.9,4.9c1.7,2.1,3,4.5,3.7,7.4c0.7,2.9,1.1,6,1.1,9.5v42.4h-10.6v-43.6c0-4-1.2-7.1-3.5-9.5
                  c-2.3-2.3-5.5-3.5-9.6-3.5c-3.2,0-6,0.5-8.4,1.5c-2.4,1-4.3,2.4-5.9,4.2c-1.6,1.8-2.8,4-3.6,6.4c-0.8,2.5-1.2,5.1-1.2,8v36.4
                  h-10.6V274.8z"/>
                <path class="st1" d="M274.7,263.2h-10.6v-13h10.6V263.2z M264.1,274.8h10.6v64.4h-10.6V274.8z"/>
                <path class="st1" d="M320.1,339.2h-11.3l-23.9-64.4h11.8l18.1,53.7h0.2l17.6-53.7h11.1L320.1,339.2z"/>
                <path class="st1" d="M408.5,318.8c-1.4,7.1-4.5,12.6-9.4,16.3c-4.8,3.7-10.9,5.6-18.2,5.6c-5.2,0-9.6-0.9-13.4-2.6
                  c-3.8-1.7-7-4-9.5-7c-2.6-3-4.5-6.6-5.8-10.7c-1.3-4.2-2-8.7-2.2-13.6c0-4.8,0.7-9.3,2.2-13.4c1.5-4.1,3.6-7.7,6.3-10.7
                  c2.7-3,5.9-5.3,9.6-7c3.7-1.7,7.7-2.5,12.1-2.5c5.7,0,10.5,1.2,14.3,3.6c3.8,2.4,6.8,5.4,9.1,9c2.3,3.7,3.9,7.6,4.7,12
                  c0.9,4.3,1.2,8.4,1.1,12.3h-48.2c-0.1,2.8,0.2,5.5,1,8c0.7,2.5,2,4.8,3.6,6.7c1.7,2,3.8,3.5,6.4,4.7c2.6,1.2,5.6,1.7,9.1,1.7
                  c4.4,0,8.1-1,11-3.1c2.9-2.1,4.8-5.2,5.7-9.5H408.5z M398.1,300.9c-0.2-2.5-0.7-4.9-1.7-7.1c-1-2.2-2.2-4.2-3.9-5.8
                  c-1.6-1.6-3.6-2.9-5.8-3.9c-2.2-1-4.7-1.4-7.2-1.4c-2.7,0-5.2,0.5-7.4,1.4c-2.2,1-4.1,2.3-5.7,3.9c-1.6,1.7-2.8,3.6-3.7,5.8
                  c-0.9,2.2-1.5,4.5-1.6,7H398.1z"/>
                <path class="st1" d="M421.2,274.8h10v13.6h0.2c2.6-5.2,5.7-9.1,9.5-11.6c3.7-2.5,8.5-3.7,14.2-3.5v11.2c-4.2,0-7.8,0.6-10.8,1.7
                  c-3,1.2-5.4,2.9-7.2,5.1c-1.8,2.2-3.2,5-4,8.2c-0.8,3.2-1.2,6.9-1.2,11v28.7h-10.6V274.8z"/>
                <path class="st1" d="M470.7,318.9c0.1,2.4,0.6,4.4,1.6,6c1,1.6,2.3,2.8,3.9,3.8c1.6,1,3.4,1.6,5.5,2.1c2,0.4,4.1,0.6,6.3,0.6
                  c1.7,0,3.4-0.1,5.2-0.4c1.8-0.2,3.5-0.7,5-1.4c1.5-0.7,2.8-1.6,3.8-2.9c1-1.3,1.5-2.9,1.5-4.9c0-2.1-0.6-3.8-1.8-5
                  c-1.2-1.3-2.8-2.3-4.7-3.2c-2-0.8-4.2-1.5-6.7-2.1c-2.5-0.5-5.1-1.1-7.8-1.7c-2.7-0.6-5.2-1.3-7.7-2.1c-2.5-0.8-4.7-1.9-6.7-3.2
                  c-2-1.3-3.6-3-4.8-5.1c-1.2-2.1-1.8-4.6-1.8-7.7c0-3.2,0.7-6,2.2-8.3c1.5-2.3,3.3-4.2,5.6-5.7c2.3-1.5,4.9-2.5,7.7-3.2
                  c2.9-0.7,5.7-1.1,8.5-1.1c3.6,0,6.9,0.3,10,0.9c3.1,0.6,5.9,1.7,8.2,3.2c2.4,1.5,4.3,3.6,5.7,6.2c1.4,2.6,2.2,5.9,2.5,9.8h-10.6
                  c-0.2-2.1-0.7-3.8-1.7-5.2c-1-1.4-2.1-2.5-3.5-3.3c-1.4-0.8-2.9-1.4-4.6-1.8c-1.7-0.4-3.4-0.6-5.2-0.6c-1.6,0-3.2,0.1-4.8,0.4
                  c-1.6,0.3-3.1,0.7-4.4,1.3c-1.3,0.6-2.4,1.5-3.2,2.6c-0.8,1.1-1.2,2.4-1.2,4c0,1.9,0.6,3.5,1.9,4.6c1.3,1.2,2.9,2.2,4.9,2.9
                  c2,0.8,4.2,1.5,6.7,2c2.5,0.5,5,1.1,7.5,1.7c2.7,0.6,5.3,1.3,7.8,2.1c2.5,0.8,4.8,1.9,6.7,3.3c2,1.4,3.5,3.1,4.7,5.2
                  c1.2,2.1,1.8,4.6,1.8,7.7c0,3.8-0.8,7-2.4,9.6c-1.6,2.6-3.7,4.7-6.4,6.3c-2.6,1.6-5.6,2.7-8.8,3.4c-3.3,0.7-6.5,1-9.8,1
                  c-3.7,0-7.1-0.4-10.3-1.2c-3.2-0.8-6-2-8.5-3.7c-2.5-1.7-4.5-3.9-6-6.7c-1.5-2.8-2.3-6.2-2.5-10.2H470.7z"/>
                <path class="st1" d="M536.5,263.2h-10.6v-13h10.6V263.2z M525.9,274.8h10.6v64.4h-10.6V274.8z"/>
                <path class="st1" d="M566.4,274.8h12.8v9.3h-12.8v40c0,1.2,0.1,2.2,0.3,3c0.2,0.7,0.6,1.3,1.2,1.7c0.6,0.4,1.4,0.7,2.4,0.8
                  c1,0.1,2.4,0.2,4,0.2h4.9v9.3h-8.1c-2.7,0-5.1-0.2-7-0.6c-2-0.4-3.5-1.1-4.7-2.1c-1.2-1-2.1-2.4-2.7-4.2
                  c-0.6-1.8-0.9-4.2-0.9-7.2v-41h-11v-9.3h11v-19.3h10.6V274.8z"/>
                <path class="st1" d="M617.5,347.8c-1.2,3.2-2.5,5.8-3.7,8c-1.2,2.2-2.5,3.9-3.9,5.3c-1.4,1.4-3,2.4-4.9,3
                  c-1.8,0.6-3.9,0.9-6.2,0.9c-1.2,0-2.5-0.1-3.7-0.2c-1.2-0.2-2.5-0.5-3.6-0.9v-9.7c1,0.3,2,0.7,3.1,1c1,0.3,2.1,0.5,3.2,0.5
                  c2.2,0,3.9-0.5,5.2-1.5c1.3-1,2.5-2.5,3.5-4.4l4.4-11l-25.5-64h12l18.8,52.7h0.2l18.1-52.7h11.2L617.5,347.8z"/>
              </g>
              <g>
                <path class="st1" d="M109.1,457.4c0-4.7,0.7-9.2,2-13.3c1.3-4.1,3.3-7.7,6-10.7c2.7-3,5.9-5.4,9.8-7.2c3.9-1.7,8.4-2.6,13.5-2.6
                  c5.1,0,9.5,0.9,13.5,2.6c3.9,1.7,7.2,4.1,9.8,7.2c2.7,3,4.7,6.6,6,10.7c1.3,4.1,2,8.5,2,13.3c0,4.7-0.7,9.1-2,13.2
                  c-1.3,4.1-3.3,7.6-6,10.7c-2.7,3-5.9,5.4-9.8,7.2c-3.9,1.7-8.4,2.6-13.5,2.6c-5.1,0-9.7-0.9-13.5-2.6c-3.9-1.7-7.1-4.1-9.8-7.2
                  c-2.7-3-4.7-6.6-6-10.7C109.8,466.5,109.1,462.1,109.1,457.4z M120.4,457.4c0,3.9,0.5,7.4,1.6,10.4c1,3,2.5,5.6,4.3,7.6
                  c1.8,2,4,3.6,6.4,4.7c2.4,1.1,5,1.6,7.8,1.6c2.7,0,5.3-0.5,7.8-1.6c2.4-1.1,4.6-2.6,6.4-4.7c1.8-2,3.3-4.6,4.3-7.6
                  c1-3,1.6-6.5,1.6-10.4c0-3.9-0.5-7.4-1.6-10.4c-1-3-2.5-5.6-4.3-7.7c-1.8-2.1-4-3.7-6.4-4.7c-2.5-1.1-5-1.6-7.8-1.6
                  c-2.7,0-5.3,0.5-7.8,1.6c-2.5,1.1-4.6,2.7-6.4,4.7c-1.8,2.1-3.3,4.6-4.3,7.7C120.9,450,120.4,453.5,120.4,457.4z"/>
                <path class="st1" d="M187.3,434.4h-10.8v-9.3h10.8v-9.6c0-5.2,1.5-9.2,4.5-11.9c3-2.7,7.5-4,13.3-4c1,0,2.1,0.1,3.4,0.2
                  c1.3,0.2,2.4,0.4,3.4,0.7v9.2c-0.9-0.3-1.9-0.6-3-0.7c-1.1-0.1-2.1-0.2-3-0.2c-2.6,0-4.6,0.5-6,1.5c-1.4,1-2.1,2.9-2.1,5.7v9
                  h12.5v9.3h-12.5v55.1h-10.6V434.4z"/>
                <path class="st1" d="M253.9,400.6h16.2l28,74.7l28.2-74.7h16.2v88.9h-11.2v-74H331l-27.8,74h-10.1l-27.8-74h-0.2v74h-11.2V400.6z
                  "/>
                <path class="st1" d="M412.5,489.5h-10v-10.2h-0.2c-2.2,4-5.1,6.9-8.7,8.8c-3.5,1.9-7.6,2.9-12.3,2.9c-4.2,0-7.8-0.6-10.6-1.7
                  c-2.8-1.2-5.1-2.8-6.9-4.9c-1.7-2.1-3-4.5-3.7-7.4c-0.7-2.9-1.1-6-1.1-9.5v-42.4h10.6v43.6c0,4,1.2,7.1,3.5,9.5
                  c2.3,2.3,5.5,3.5,9.6,3.5c3.2,0,6-0.5,8.4-1.5c2.4-1,4.3-2.4,5.9-4.2c1.6-1.8,2.8-4,3.6-6.4c0.8-2.4,1.2-5.1,1.2-8v-36.4h10.6
                  V489.5z"/>
                <path class="st1" d="M427.2,425.1h10v10.2h0.3c2.2-4,5.1-6.9,8.7-8.8c3.5-1.9,7.6-2.9,12.3-2.9c4.2,0,7.8,0.6,10.6,1.7
                  c2.8,1.2,5.1,2.8,6.9,4.9c1.7,2.1,3,4.5,3.7,7.4c0.7,2.9,1.1,6,1.1,9.5v42.4h-10.6v-43.6c0-4-1.2-7.1-3.5-9.5
                  c-2.3-2.3-5.5-3.5-9.6-3.5c-3.2,0-6,0.5-8.4,1.5c-2.4,1-4.3,2.4-5.9,4.2c-1.6,1.8-2.8,4-3.6,6.4c-0.8,2.5-1.2,5.1-1.2,8v36.4
                  h-10.6V425.1z"/>
                <path class="st1" d="M506.4,413.5h-10.6v-13h10.6V413.5z M495.8,425.1h10.6v64.4h-10.6V425.1z"/>
                <path class="st1" d="M565.3,445.8c-0.8-4.1-2.6-7.2-5.3-9.5c-2.7-2.2-6.2-3.4-10.7-3.4c-3.8,0-7,0.7-9.6,2.1
                  c-2.6,1.4-4.6,3.3-6.2,5.6c-1.5,2.3-2.6,5-3.3,8c-0.7,3-1,6.2-1,9.4c0,3,0.4,5.9,1.1,8.7c0.7,2.8,1.8,5.3,3.3,7.5
                  c1.5,2.2,3.4,4,5.8,5.3c2.4,1.3,5.3,2,8.7,2c5.1,0,9.2-1.4,12.2-4.2c3-2.8,4.8-6.6,5.5-11.5h10.8c-1.2,7.9-4.2,14-9,18.4
                  c-4.8,4.4-11.3,6.6-19.4,6.6c-4.9,0-9.2-0.8-13-2.4c-3.8-1.6-6.9-3.9-9.5-6.8c-2.5-2.9-4.4-6.4-5.7-10.4c-1.3-4-1.9-8.4-1.9-13.3
                  c0-4.8,0.6-9.3,1.9-13.5c1.2-4.2,3.1-7.8,5.7-11c2.5-3.1,5.7-5.6,9.5-7.3c3.8-1.8,8.2-2.7,13.4-2.7c3.7,0,7.1,0.4,10.3,1.3
                  c3.2,0.9,6,2.2,8.5,4c2.5,1.8,4.5,4.1,6,6.9c1.5,2.8,2.5,6.1,2.9,9.9H565.3z"/>
                <path class="st1" d="M587.2,400.6h10.6v34h0.2c0.8-1.9,2-3.6,3.6-5c1.5-1.4,3.2-2.6,5-3.4c1.8-0.9,3.8-1.5,5.8-1.9
                  c2-0.4,4-0.6,5.9-0.6c4.2,0,7.8,0.6,10.6,1.7c2.8,1.2,5.1,2.8,6.9,4.9c1.7,2.1,3,4.5,3.7,7.4c0.7,2.9,1.1,6,1.1,9.5v42.4H630
                  v-43.6c0-4-1.2-7.1-3.5-9.5c-2.3-2.3-5.5-3.5-9.6-3.5c-3.2,0-6,0.5-8.4,1.5c-2.4,1-4.3,2.4-5.9,4.2c-1.6,1.8-2.8,4-3.6,6.4
                  c-0.8,2.5-1.2,5.1-1.2,8v36.4h-10.6V400.6z"/>
              </g>
            </g>
          </g>
          </svg>
          </a>
        </div>

        <div style="flex: 1; display: flex; justify-content: center; align-items: center;">
        <a href="https://www.leti-cea.com/cea-tech/leti/english/Pages/Applied-Research/Facilities/micro-nano-technolgies-health.aspx" target="_blank" style="color: white; text-decoration: none;">
          <!-- Micro-Nano Technology<br>CEA Leti -->
          <svg
          version="1.1"
          id="svg1274"
          viewBox="0 0 1535.7333 760.65601"
          style="height: 50px; width: auto;"
          sodipodi:docname="LETI.ai"
          xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
          xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:svg="http://www.w3.org/2000/svg">
         <defs
            id="defs1278">
           <clipPath
              clipPathUnits="userSpaceOnUse"
              id="clipPath1292">
             <path
                d="M 0,570.492 H 1151.802 V 0 H 0 Z"
                id="path1290" />
           </clipPath>
         </defs>
         <g
            id="g1282"
            inkscape:groupmode="layer"
            inkscape:label="Page 1"
            transform="matrix(1.3333333,0,0,-1.3333333,0,760.656)">
           <path
              d="M 0,0 H 570.492 V 570.492 H 0 Z"
              style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none"
              id="path1284" />
           <g
              id="g1286">
             <g
                id="g1288"
                clip-path="url(#clipPath1292)">
               <g
                  id="g1294"
                  transform="translate(436.8285,274.644)">
                 <path
                    d="m 0,0 c -8.225,-9.429 -20.589,-13.566 -36.316,-13.702 -35.839,-0.312 -39.328,13.284 -39.328,13.284 -3.71,8.333 8.385,25.154 83.295,64.852 C 9.482,59.832 11.025,53.904 11.962,48.33 12.008,48.032 15.887,18.217 0,0 m -198.068,31.195 c -0.045,0.298 -3.921,30.115 11.961,48.334 8.225,9.427 20.376,14.206 36.097,14.206 16.951,0 31.162,-5.903 32.63,-12.696 1.097,-5.078 -3.71,-11.586 -25.612,-29.131 -0.226,-0.195 -22.365,-18.976 -50.943,-35.932 -1.807,4.569 -3.197,9.697 -4.133,15.219 M 25.64,39.282 c 0,63.759 -48.48,68.272 -58.633,68.272 -15.76,0 -30.971,-3.275 -46.979,-9.586 l -1.129,-16.799 c 6.228,2.923 26.185,11.493 46.078,11.493 15.663,0 27.731,-5.252 35.895,-15.62 -53.898,-28.353 -86.054,-51.149 -90.905,-70.064 -13.797,-9.327 -38.109,-20.09 -59.734,-20.09 -23.049,0 -32.956,9.952 -37.276,15.73 59.144,39.79 89.8,62.744 86.045,80.865 -3.379,16.35 -27.672,24.023 -49.435,24.023 -22.278,0 -37.576,-9.614 -44.819,-17.081 -11.643,-12.008 -17.188,-29.808 -16.477,-52.891 0.313,-10.093 2.299,-20.614 5.657,-29.838 -9.07,-5.899 -33.782,-20.838 -62.157,-20.838 -33.701,0 -47.563,26.333 -47.563,52.908 0,25.763 12.955,52.93 47.563,52.93 19.466,0 39.018,-8.216 45.678,-11.306 l -1.124,16.767 c -12.564,4.911 -29.11,9.351 -43.423,9.351 -57.31,0 -62.04,-48.105 -61.78,-67.711 -0.26,-19.642 4.978,-67.746 61.251,-67.746 34.051,0 62.965,18.693 68.241,22.089 3.654,-6.376 18.142,-22.096 49.464,-22.096 24.801,0 52.331,12.338 61.516,18.281 5.628,-7.53 17.138,-18.318 52.264,-18.318 23.218,0 37.934,8.054 47.156,19.128 0.175,-5.832 0.385,-11.512 0.652,-15.881 l 14.056,-2.166 c -0.47,14.646 -0.082,65.419 -0.082,66.194"
                    style="fill:#010101;fill-opacity:1;fill-rule:nonzero;stroke:none"
                    id="path1296" />
               </g>
               <g
                  id="g1298"
                  transform="translate(1151.802,0.5704)">
                 <path
                    d="M 0,0 H -203.041 V 14.597 H -14.597 V 203.041 H 0 Z"
                    style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none"
                    id="path1300" />
               </g>
               <path
                  d="m 699.965,243.901 h -22.709 v 184.667 h 22.709 z"
                  style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none"
                  id="path1302" />
               <g
                  id="g1304"
                  transform="translate(841.7052,344.595)">
                 <path
                    d="m 0,0 c -3.828,6.238 -9.026,10.979 -15.597,14.224 -6.573,3.244 -13.849,4.866 -21.835,4.866 -11.479,0 -21.255,-3.661 -29.322,-10.98 -8.071,-7.323 -12.687,-17.468 -13.85,-30.445 H 5.74 C 5.74,-13.687 3.825,-6.239 0,0 M 28.449,-40.802 H -80.854 c 0.832,-13.475 5.448,-23.999 13.851,-31.568 8.399,-7.572 18.591,-11.354 30.569,-11.354 9.815,0 18.007,2.284 24.58,6.862 6.571,4.573 11.188,10.688 13.851,18.342 h 24.456 c -3.662,-13.145 -10.98,-23.832 -21.961,-32.067 -10.979,-8.235 -24.623,-12.353 -40.926,-12.353 -12.976,0 -24.581,2.909 -34.812,8.734 -10.232,5.822 -18.26,14.1 -24.081,24.831 -5.825,10.73 -8.735,23.165 -8.735,37.308 0,14.138 2.828,26.534 8.485,37.182 5.654,10.645 13.6,18.841 23.832,24.581 10.231,5.74 22,8.61 35.311,8.61 12.977,0 24.456,-2.831 34.438,-8.486 9.982,-5.657 17.675,-13.436 23.083,-23.332 5.404,-9.9 8.11,-21.087 8.11,-33.564 0,-4.328 -0.249,-8.903 -0.748,-13.726"
                    style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none"
                    id="path1306" />
               </g>
               <g
                  id="g1308"
                  transform="translate(936.0343,361.9377)">
                 <path
                    d="m 0,0 v -80.604 c 0,-6.656 1.412,-11.354 4.242,-14.1 2.827,-2.745 7.737,-4.118 14.724,-4.118 h 16.72 v -19.215 H 15.223 c -12.646,0 -22.128,2.91 -28.449,8.735 -6.325,5.821 -9.483,15.385 -9.483,28.698 V 0 h -17.718 v 18.717 h 17.718 V 53.154 H 0 V 18.717 H 35.686 V 0 Z"
                    style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none"
                    id="path1310" />
               </g>
               <path
                  d="m 1029.364,243.901 h -22.709 v 136.753 h 22.709 z m -21.96,163.455 c -2.994,2.995 -4.492,6.652 -4.492,10.98 0,4.324 1.498,7.986 4.492,10.981 2.995,2.994 6.653,4.491 10.981,4.491 4.156,0 7.692,-1.497 10.605,-4.491 2.91,-2.995 4.368,-6.657 4.368,-10.981 0,-4.328 -1.458,-7.985 -4.368,-10.98 -2.913,-2.994 -6.449,-4.491 -10.605,-4.491 -4.328,0 -7.986,1.497 -10.981,4.491"
                  style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:none"
                  id="path1312" />
               <path
                  d="m 121.509,202.197 h 327.11 v -13.903 h -327.11 z"
                  style="fill:#010101;fill-opacity:1;fill-rule:nonzero;stroke:none"
                  id="path1314" />
             </g>
           </g>
         </g>
       </svg>

        </a>
      </div>
    </div>
  </footer>


  <script>
    async function sendData() {
      const spheroid_diameter = document.getElementById('spheroid_diameter').value;
      const nr_of_traps = document.getElementById('nr_of_traps').value;
      const channel_negative = document.getElementById('geometryToggle').checked; // boolean value

      try {
        const response = await fetch('/compute', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ 
            spheroid_diameter: spheroid_diameter, 
            nr_of_traps: nr_of_traps,
            channel_negative: channel_negative
          })
        });

        const data = await response.json();

        // // Add Output Text
        // let resultText = `For a spheroid diameter of ${spheroidDiameter} µm and ${numTraps} traps, 
        //               the restulting flow ratio is todo.`;

        // Display result data
        document.getElementById('resultData').innerHTML = `${data.result_data}`;
        // document.getElementById('resultData').style.display = 'block';

        // // Display SVG image
        // const svgImage = document.getElementById('resultSvg');
        // svgImage.src = `/svg/${data.svg_filename}`;
        // svgImage.style.display = 'block';

        // Load STL into the viewer
        loadSTL(`/stl/${data.output_id}/${data.stl_filename}`);

        // Enable and set download buttons
        const downloadButtons = document.getElementById('downloadButtons');
        downloadButtons.style.display = 'block'; // Show buttons

        const downloadSTL = document.getElementById('downloadSTL');
        downloadSTL.href = `/stl/${data.output_id}/${data.stl_filename}`; // Set STL download link

        const downloadDXF = document.getElementById('downloadDXF');
        downloadDXF.href = `/dxf/${data.output_id}/${data.dxf_filename}`; // Set STL download link

        const downloadSVG = document.getElementById('downloadSVG');
        downloadSVG.href = `/svg/${data.output_id}/${data.svg_filename}`; 
        
      } catch (error) {
        console.error('Error:', error);
      }
    }

  function loadSTL(stlUrl) {
    const container = document.getElementById('stlViewer');
    container.innerHTML = ''; // Clear previous viewer if any

    // Create the Three.js scene
    const scene = new THREE.Scene();

    // Create a camera with a basic perspective
    const camera = new THREE.PerspectiveCamera(75, container.offsetWidth / container.offsetHeight, 0.1, 1000);
    camera.position.z = 100; // Set camera distance

    // Create a renderer and attach it to the container;
    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(container.offsetWidth, container.offsetHeight);
    renderer.setClearColor(0xffffff, 1); // Set white background
    container.appendChild(renderer.domElement);

    // Add a basic white ambient light
    const ambientLight = new THREE.AmbientLight(0xffffff); // White light
    scene.add(ambientLight);

    // Add OrbitControls for user interaction
    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true; // Smooth motion
    controls.dampingFactor = 0.05;
    controls.screenSpacePanning = false; // Disable screen panning
    controls.minDistance = 20; // Limit zoom-in
    controls.maxDistance = 200; // Limit zoom-out

    // Load the STL file
    const loader = new THREE.STLLoader();
    loader.load(
      stlUrl,
      function (geometry) {
        console.log('STL geometry loaded:', geometry);

        const material = new THREE.MeshPhongMaterial({
          color: 0x005293,    // TUM blue dark
          shininess: 10,     // Shiny surface
          specular: 0x333333, // Specular highlights
          transparent: true,   // Enable transparency
          opacity: 0.9,        // Set opacity to 
        });

        const mesh = new THREE.Mesh(geometry, material);
        scene.add(mesh);

        // Center the geometry
        const boundingBox = new THREE.Box3().setFromObject(mesh);
        const center = boundingBox.getCenter(new THREE.Vector3());
        // mesh.position.sub(center);

        mesh.geometry.center();

        // Scale the geometry to fit into the scene
        const size = boundingBox.getSize(new THREE.Vector3());
        const maxDimension = Math.max(size.x, size.y, size.z);
        mesh.scale.setScalar(65 / maxDimension); // Scale to fit within a 50x50x50 box

        // Ambient light for overall brightness
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.6); // Soft white light
        scene.add(ambientLight);

        // Point light for highlights
        const pointLight = new THREE.PointLight(0xffffff, 0.2);
        pointLight.position.set(50, 50, 50); // Position the light source
        scene.add(pointLight);

        console.log('Scene children:', scene.children); // Log all objects in the scene

        // Animation loop -- drag to rotate
        function animate() {
          requestAnimationFrame(animate); // Schedule the next frame
          controls.update(); // Update controls
          renderer.render(scene, camera); // Render the scene
        }

        animate(); // Start the animation loop
      },
    
      undefined,
      function (error) {
        console.error('Error loading STL:', error);
      }
    );
  }
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/110/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.110/examples/js/loaders/STLLoader.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.110/examples/js/controls/OrbitControls.js"></script>

  </body>
</html>
